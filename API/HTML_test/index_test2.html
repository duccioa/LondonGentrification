<!-- This is a test for the visualization of geoJSON on googlemap
The key points here are:
- Original shapefiles are converted to WSG84 with the R code and stored in the folder data/ESRI/simplified
- Shape files are simplified through mapshaper
- The resulting json are loaded in http://geojson.io and saved as GeoJSON. This passage is necessary because saving directly from mapshaper gives faulty files. I am sure this can be worked out in a better way but for the moment, this is the way
- the reference to the file is inserted as "data/geo/[filename.geojson]"
- The googlemap api key
-->



<!DOCTYPE html>
<head>
	<title>SDC: Food Premises</title>
	<link rel='stylesheet' id='font-css'  href='http://fonts.googleapis.com/css?family=Roboto:400,300,100' type='text/css' media='all' />
	<link rel='stylesheet' id='font-css'  href='./css/style.css' type='text/css' media='all' />
</head>
<body>
<div id='wrapper'>
     <div id='map-canvas'></div>
     <div id="titleHeader">
     	 <h1>SDC: Food Premises</h1>
     </div>
     
</div>



<!-- START the chunk to be copied and paste -->
<!-- The Javascript from external websites gets Loaded Here -->
<script type='text/javascript' src='http://code.jquery.com/jquery-1.10.2.min.js?ver=1.10.2'></script>
<!-- key=AIzaSyA7UJ1JbKnBvycoS-SATXKgf7HwUdxWPZA& -->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCpXEKSVGbwdXnyk3WRE3c2g_nl2g9rhPM&libraries=visualization"> </script>
<script type='text/javascript' src='http://arshaw.com/xdate/downloads/0.8/xdate.js'></script>
<script type='text/javascript' src='./js/mapStyle.js'></script>

<!-- The Javascript gets loaded here -->
<script type="text/javascript">
	var map;
	var infowindow = new google.maps.InfoWindow({maxWidth: 300});

	var port = 8874;

	$(document).ready(function() {

		    function initialize(){
			var mapOptions = {
				center: new google.maps.LatLng(51.514756, -0.104345),
				zoom: 14,
			 	styles: darkMap
			};
			
			map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
                    // Load GeoJSON.
        console.log("Loading GeoJson");
        map.data.loadGeoJson('map.geojson');

        // Set the stroke width, and fill color for each polygon
        map.data.setStyle({
          fillColor: 'green',
          strokeWeight: 1
        });}

            google.maps.event.addDomListener(window, 'load', initialize);
            });
			






	//  ******************* FUNCTIONS TO USE FOR THE MAP YOU DON"T NEED TO EDIT ANYTHING BELOW THIS LINE **************************************************
	
	function createMarkers(){
		var marker = new google.maps.Marker({
  			position: latLng 				
  		});
	}

	function setAllMap(map) {
		for (var i = 0; i < markerArray.length; i++) {
			markerArray[i].setMap(map);
		}
	}

	function clearMarkers() {
		setAllMarkers(null);
	}

	String.prototype.replaceAll = function(str1, str2, ignore) {
    	return decodeURIComponent( this.replace(new RegExp(str1.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),(ignore?"gi":"g")),(typeof(str2)=="string")?str2.replace(/\$/g,"$$$$"):str2) );
	} 


</script>
<!-- END the chunk to be copied and pasted -->


</body>
</html>