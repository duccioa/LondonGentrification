<!DOCTYPE html>
<head>
   <meta charset="UTF-8" />
   <meta http-equiv="X-UA-Compatible" content="chrome=edge">
   <title>London Gentrification</title>
   <link rel="stylesheet" type="text/css" href="./css/style.css" />
   <script type='text/javascript' src='http://code.jquery.com/jquery-1.10.2.min.js?ver=1.10.2'></script>
   <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA7UJ1JbKnBvycoS-SATXKgf7HwUdxWPZA&libraries=visualization"> </script>
   <script type='text/javascript' src='http://arshaw.com/xdate/downloads/0.8/xdate.js'></script>
   <script type='text/javascript' src='./js/mapStyle.js'></script>
   <script type="text/javascript"  src="./js/effect.js"></script>
   <script type="text/javascript" src="./js/modernizr_custom_29473.js"></script>
   <script type="text/javascript" src="./js/map_functions.js"></script>
   <style>
      html, body {
      height: 100%;
      margin:0;
      padding: 0;
      }
   </style>
</head>
<body>
   <div id="map-canvas" class="googlemap"></div>
   <!-- The Javascript gets loaded here -->
   <script type="text/javascript">
      var map;
      var markerArray = [];
      var dataArray = [];
      var infowindow = new google.maps.InfoWindow({maxWidth: 300});
      var port = 8866;
      console.log('1.GET_JGEOJSON_DATA: Create variables');//DEBUG
      var GSS_code = [];
      var WardName = [];
      var BoroughName = [];
      var MedianIncome_2012_13 = [];
      var IncomeLabel = [];
      var Area_Km2 = [];
      var MedianIncome_col = [];

      
      
      
      
      $(document).ready(function() {
      // Register Click events 
      $("#resetLink").click( function(event){
          event.preventDefault();
          location.reload();
      });
      
      $("#clearLink").click( function(event){
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'dragend');
          $("#photoNum").html("0");
      });
      
      // Token buttons
      $("#cafe").click( function(event){
          token = 'cafe';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#coffee").click( function(event){
          token = 'coffee';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#pizza").click( function(event){
          token = 'pizza';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#wine").click( function(event){
          token = 'wine';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#grill").click( function(event){
          token = 'grill';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#sushi").click( function(event){
          token = 'sushi';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#thai").click( function(event){
          token = 'thai';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#chicken").click( function(event){
          token = 'chicken';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#fried").click( function(event){
          token = 'fried';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#fish").click( function(event){
          token = 'fish';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#kebab").click( function(event){
          token = 'kebab';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      $("#waitrose").click( function(event){
          token = 'waitrose';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#sainsbury").click( function(event){
          token = 'sainsbury';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#tesco").click( function(event){
          token = 'tesco';
          viz = 'MedianIncome_col';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          //Clear Markers
          setAllMap(null);
          google.maps.event.clearListeners(map, 'bounds_changed');
          $("#premisesNum").html("0");
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          setupTokenMap(token, viz);
          $("#describeWords").load(link2analysis);
      });
      
      $("#costcutter").click( function(event){
          token = 'costcutter';
          viz = 'scatter';
          var link2analysis = './text/'+token+'_analysis.html';
          event.preventDefault();
          setAllMap(null);//Clear Markers
          setupTokenMap(token, viz);
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
          $("#describeWords").load(link2analysis);
      });
      // Visualisation buttons		
       $("#income").click( function(event){
          //this.setMap(null);
          var viz = 'income';
          //event.preventDefault();
          //Clear Markers
          setAllMap(null);
          changeViz(wards_poly, wards_json,'fillColor', setupViz(viz));
          google.maps.event.clearListeners(map, 'bounds_changed');
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
      });
      
      $("#lq").click( function(event){
          //this.setMap(null);
          var viz = 'lq';
          //event.preventDefault();
          //Clear Markers
          setAllMap(null);
          changeViz(wards_poly, wards_json,'fillColor', setupViz(viz));
          google.maps.event.clearListeners(map, 'bounds_changed');
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
      });
      $("#lmoran").click( function(event){
          //this.setMap(null);
          var viz = 'lmoran';
          //event.preventDefault();
          //Clear Markers
          setAllMap(null);
          changeViz(wards_poly, wards_json,'fillColor', setupViz(viz));
          google.maps.event.clearListeners(map, 'bounds_changed');
          console.log('Setup the filter to ' + token + " and visualisation to " + viz);
      });
      
      function initialize() {
        token = 'cafe'; // first page shows results for cafe
        viz = 'income'; //first page shows scatter plot of premises
        
        var mapOptions = {
          center: new google.maps.LatLng(51.514756, -0.104345),
          zoom: 10,
          	styles: darkMap
        };
      console.log('Initialise map');
      map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
              // Load ward shapes
              
              $.get('data/geo/London_Ward_CityMerged_WGS84.geojson', function(data) {
                      wards_json = JSON.parse(data);
                      wards_poly = drawPolys(wards_json, 0.5, 1, '#cccccc', 0.7,'yes');
                      changeViz(wards_poly, wards_json,'fillColor', setupViz(viz));
                      
                  });
              $.get('data/geo/London_Boroughs_WGS84.geojson', function(data) {
                      boroughs_json = JSON.parse(data);
                      boroughs_poly = drawPolys(boroughs_json, 1, 2, '#f2f2f2', 0,'no');
                  });
        toggleMap(false);          
        setupTokenMap(token);// Setup the page at the opening of the page
      }  
       
      
      
      
      google.maps.event.addDomListener(window, 'load', initialize);
      
      });
      
      

      String.prototype.replaceAll = function(str1, str2, ignore) {
      	return decodeURIComponent( this.replace(new RegExp(str1.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),(ignore?"gi":"g")),(typeof(str2)=="string")?str2.replace(/\$/g,"$$$$"):str2) );
      };
      
      
      
      
      
   </script>
   <div id='wrapper'>
      <!--sidebar-->
      <div id="sidebar" class="bar" style="text-align:left;">
         <h1>London Gentrification</h1>
         <input name="button1" type="button" value="The Project" class="button description" onclick=button1();>
         <input name="button2" type="button" value="Methodology" class="button methodology" onclick=button2();>
         <input name="button3" type="button" value="Team" class="button graphs" onclick=button3();>
         <input name="button4" type="button" value="Data Sources" class="button data" onclick=button4();>
      </div>
      <!--button description slideToggle-->
      <div id="content1" class="desContent">
         <p>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>
      </div>
      <div id="content2" class="methodContent">
         <p>ssssssssssssssssssssssssssssssssss</p>
      </div>
      <div id="content3" class="graphsContent">
         <p>fffffffffffffffffffffffff</p>
      </div>
      <div id="content4" class="dataContent">
         <p>hhhhhhhhhhhhhhhhhhhhhhhhh</p>
      </div>
      <!--filterbar-->
      <div id="filterbar" class="rightbar" >
         <button  class="filters"  onclick=filterclick();>F</br>I</br>L</br>T</br>E</br>R</button>
         <button id="plotbtn" class="plots"  onclick=plotclick();>P</br>L</br>O</br>T</br>S</button>
      </div>
      <div id="filtermenu" class="fmenu">
         <p>Tokens</p>
         <table class="tokens">
            <tr>
               <td><button><a href="#" id="cafe">Cafe</a></button></td>
               <td><button><a href="#" id="coffee">Coffee</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="pizza">Pizza</a></button></td>
               <td><button><a href="#" id="grill">Grill</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="wine">Wine</a></button></td>
               <td><button><a href="#" id="sushi">Sushi</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="thai">Thai</a></button></td>
               <td><button><a href="#" id="chicken">Chicken</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="fried">Fried</a></button></td>
               <td><button><a href="#" id="fish">Fish</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="kebab">Kebab</a></button></td>
               <td><button><a href="#" id="waitrose">Waitrose</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="sainsburys">Sainsburys</a></button></td>
               <td><button><a href="#" id="tesco">Tesco</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="costcutter">Costcutter</a></button></td>
            </tr>
         </table>
         <p>Visualization</p>
         <table class="visualization">
            <tr>
               <td><button><a href="#" id="income">Income Levels</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="lq">Concentration (LQ)</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="lmoran">Clusters (LMs)</a></button></td>
            </tr>
            <tr>
               <td><button><a href="#" id="gwr">Correlation (GWR)</a></button></td>
            </tr>
         </table>
         <table class="clearbutton">
            <tr>
               <td><button><a href="#" id="clear">Reset</a></button></td>
            </tr>
         </table>
      </div>
      <!--plotbar-->
      <div id="plottab" class="ptab">
         <div id="describeWords" class="dWords">
            <!--<iframe src = "./text/cafe_analysis.html" name="targetframe" allowTransparency="true" scrolling="yes" frameborder="0" > 
               </iframe>-->
         </div>
         <div id="plotgraph" class="pgraph" >
            <img class="plot1"  src="./img/downloadedImage.jpg"  style="width:99%;height:100%;padding-top:5px;padding-right:8px;">
            <img class="plot1"  src="./img/TOTALtu.jpg"  style="width:99%;height:100%;padding-top:5px;padding-right:8px;">
            <a class="w3-btn-floating" style="position:absolute;top:45%;left:0" onclick="plusDivs(-1)">❮</a>
            <a class="w3-btn-floating" style="position:absolute;top:45%;right:0" onclick="plusDivs(1)">❯</a> 
         </div>
      </div>
      <script>
         //  ************* 
              var slideIndex = 1;
              showDivs(slideIndex);
         
              function plusDivs(n) {
              showDivs(slideIndex += n);
              }
         
              function showDivs(n) {
              var i;
              var x = document.getElementsByClassName("plot1");
              if (n > x.length) {slideIndex = 1;}    
              if (n < 1) {slideIndex = x.length;}
              for (i = 0; i < x.length; i++) {
              x[i].style.display = "none";  
              }
              x[slideIndex-1].style.display = "block";  
              }
         //  *************
      </script>
   </div>
</body>
</html>